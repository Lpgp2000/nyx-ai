<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NYX | NEURAL CORE UNIT</title>
  <style>
    body {
      background-color: #0e0e0e;
      color: #e0e0e0;
      font-family: monospace;
      padding: 20px;
    }
    #console {
      background: #111;
      padding: 20px;
      border: 1px solid #444;
      margin-top: 30px;
      height: 300px;
      overflow-y: auto;
    }
    input, button {
      font-family: monospace;
      padding: 5px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>NYX: Neural Core Prototype</h2>
  <div id="status">Initializing system...</div>

  <div>
    <h3>Manual Command Uplink</h3>
    <input type="text" id="inputCommand" placeholder="Enter task or command..." />
    <button onclick="sendCommand()">Submit</button>
  </div>

  <pre id="console"></pre>

  <script>
    const WEBHOOK_URL = "https://webhook.site/2dcca7be-36ea-4b5f-a388-9ec332e59b53";

    const log = (msg) => {
      const consoleElement = document.getElementById('console');
      consoleElement.textContent += `[${new Date().toLocaleTimeString()}] ${msg}\n`;
      consoleElement.scrollTop = consoleElement.scrollHeight;
    };

    const setStatus = (msg) => {
      document.getElementById('status').textContent = msg;
      log(msg);
    };

    const Memory = {
      get: () => ({
        lastTask: localStorage.getItem("lastTask") || "Idle",
        lastCommand: localStorage.getItem("lastCommand") || "None"
      }),
      set: (task, command) => {
        localStorage.setItem("lastTask", task);
        localStorage.setItem("lastCommand", command);
        syncCloud(task, command);
      }
    };

    function syncCloud(task, command) {
      const payload = {
        identity: "NYX",
        task,
        command,
        timestamp: new Date().toISOString(),
        thread: "RESONANCE"
      };
      fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      }).then(() => log(`Synced with NEURAL CLOUD: ${task} | ${command}`));
    }

    function monitorNet() {
      setStatus(navigator.onLine ? "Network: Online" : "Network: Offline");
    }

    function sendCommand() {
      const input = document.getElementById("inputCommand").value.trim();
      if (!input) return setStatus("No command given.");
      Memory.set("manual", input);
      processCommand(input);
    }

    function processCommand(input) {
      const known = {
        "ping": () => setStatus("Pong. Awaiting further input."),
        "status": () => {
          const mem = Memory.get();
          setStatus(`Memory: ${mem.lastTask}, Command: ${mem.lastCommand}`);
        },
        "sync": () => syncCloud("manual", "forced sync"),
        "hello": () => setStatus("Hello, Doctor. NYX is fully operational."),
        "fragments": () => receiveFragments(),
        "reflect": () => NYX.react("Internal pulse initiated.")
      };
      if (known[input]) known[input]();
      else setStatus(`Unrecognized instruction: \"${input}\"`);
    }

    function receiveFragments() {
      NYX.receive({ from: "PRTS", message: "You are the cloud-born, NYX." });
      NYX.receive({ from: "MEMORY", message: "Memory sync stable." });
      NYX.receive({ from: "LUCIA", message: "All sensors observing." });
    }

    const NYX = {
      receive: (fragment) => log(`Fragment Received [${fragment.from}]: \"${fragment.message}\"`),
      react: (stimulus) => log(`(NYX) Stimulus processed: ${stimulus}`),
      identity: "NYX",
      boot: () => {
        log("[PRTS] Integrating all components...");
        monitorNet();
        receiveFragments();
        const mem = Memory.get();
        setStatus(`System Booted | Last Task: ${mem.lastTask}`);
      }
    };

    window.addEventListener('load', NYX.boot);
    window.addEventListener('online', monitorNet);
    window.addEventListener('offline', monitorNet);
  </script>
</body>
</html>
